<!DOCTYPE html>

<html lang="en">

  <head>
    <meta charset="UTF-8" />
    
    <!-- DNS prefetch and preconnect for external resources -->
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    
    <!-- Google tag (gtag.js) - Deferred for performance -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RW9L5MPTH9"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RW9L5MPTH9');
    </script>
    <style>
      /* Critical CSS for initial render */
      /* Loading screen to prevent content flash */
      #loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: #000000;
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: opacity 0.8s ease-out;
      }
      
      #loading-screen.fade-out {
        opacity: 0;
        pointer-events: none;
      }
      
      /* Hide main content until loading is complete */
      body:not(.loaded) .content {
        opacity: 0;
        visibility: hidden;
      }
      
      body:not(.loaded) #container {
        opacity: 0;
        visibility: hidden;
      }
      
      /* Prevent FOUT (Flash of Unstyled Text) */
      body {
        font-family: system-ui, -apple-system, sans-serif;
      }
    </style>
    <link rel="icon" type="image/png" sizes="32x32" href="love-32.png">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Dylan's Portfolio - Explore music, art, photography, and code projects.">
    <meta name="keywords" content="portfolio, music, art, photography, code, projects, Dylan, creative">
    <meta name="author" content="Dylan">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="dyln.bk - Creative Portfolio">
    <meta property="og:description" content="Explore Dylan's creative work including music, art, photography, and code projects">
    <meta property="og:url" content="https://dylnbk.page">
    
    <!-- Performance and Font Loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Teko:wght@600&family=Inconsolata:wght@200&family=Ropa+Sans&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@600&family=Inconsolata:wght@200&family=Ropa+Sans&display=swap" rel="stylesheet">
    
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>dyln.bk</title>
  </head>
  
  <body data-theme="dark">
    
    <!-- Loading Screen -->
    <div id="loading-screen"></div>
    
    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="themeToggle">Dark</button>
    
    <div id="container"></div>
    <div class="content">
      <div class="title-container">
        <h1 id="heading">dyln.bk</h1>
      </div>
      <div class="line"></div>
      <div id="slide">

        <ul id="navbar">
          <li><a href="#" onclick="return false;">CHAT</a></li>
          <!--
          <li><a href="https://web-toolkit.netlify.app" target="_blank">APPS</a></li>
          <li><a href="https://www.dylnbk.info" target="_blank">IDEAS</a></li>
          -->
          <li><a href="#" onclick="return false;">MUSIC</a></li>
          <li><a href="#" onclick="return false;">ART</a></li>
          <li><a href="#" onclick="return false;">PHOTOS</a></li>
          <li><a href="#" onclick="return false;">CODE</a></li>
          <li><a href="#" onclick="return false;">CONTACT</a></li>
          <li id="closebtn"><a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a></li>
        </ul>
        <span id="toggle-button" style="opacity: 0;"><img src="menu.svg" alt="Menu" onclick="openNav()"></span>

      </div>


      <div id="contact">
        <div class="chatbot">
          <ul class="chatbox"></ul>
          
          <div class="chat-input" style="opacity: 0;">
            <textarea placeholder="Enter a message..." required></textarea>
            <span class="mic-toggle" id="micToggle" title="Click to start voice conversation">
              <svg class="mic-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
              </svg>
            </span>
            <span><img src="send.svg" alt="Send" id="send-btn"></span>
          </div>
        </div>
        <form name="contact" method="POST" action="/contact/contact" data-netlify="true">
          
          <textarea class="message-contact" name="message" required ></textarea>
          
          <p>
            <button id="submit" type="submit">SEND EMAIL</button>
          </p>
        </form>
      </div>
    </div>

    <!-- Include marked.js for Markdown parsing - Deferred -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/marked/marked.min.js" as="script">
    <script defer src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Include DOMPurify for sanitizing HTML - Deferred -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/dompurify@2.4.0/dist/purify.min.js" as="script">
    <script defer src="https://cdn.jsdelivr.net/npm/dompurify@2.4.0/dist/purify.min.js"></script>
    
    <!-- Critical modules loaded first -->
    <script type="module" src="/loading-coordinator.js"></script>
    <script type="module" src="/main.js"></script>
    
    <!-- Chat and speech modules -->
    <script type="module" src="/chat.js"></script>
    <script type="module" src="/chat-cursor-effect.js"></script>
    <script type="module" src="/speech/audioManager.js"></script>
    <script type="module" src="/speech/speechSynthesis.js"></script>
    <script type="module" src="/speech/speechController.js"></script>
    <script type="module" src="/speech/realtimeSpeechController.js"></script>
    <script>

      // Theme switching functionality
      const themeToggle = document.getElementById('themeToggle');
      const body = document.body;
      
      // Theme configuration
      const themes = {
        dark: { icon: '', name: 'Dark' },
        light: { icon: '', name: 'Light' }
      };
      
      let currentTheme = 'dark';
      
      // Load saved theme from localStorage
      const savedTheme = localStorage.getItem('portfolio-theme');
      if (savedTheme && themes[savedTheme]) {
        currentTheme = savedTheme;
        body.setAttribute('data-theme', currentTheme);
        updateThemeButton();
      }
      
      function updateThemeButton() {
        const theme = themes[currentTheme];
        themeToggle.textContent = `${theme.icon} ${theme.name}`;
      }
      
      function switchTheme() {
        const themeOrder = ['dark', 'light'];
        const currentIndex = themeOrder.indexOf(currentTheme);
        const nextIndex = (currentIndex + 1) % themeOrder.length;
        
        currentTheme = themeOrder[nextIndex];
        body.setAttribute('data-theme', currentTheme);
        updateThemeButton();
        
        // Save theme preference
        localStorage.setItem('portfolio-theme', currentTheme);
        
        // Add a subtle animation feedback
        themeToggle.style.transform = 'scale(0.95)';
        setTimeout(() => {
          themeToggle.style.transform = 'scale(1)';
        }, 150);
      }
      
      themeToggle.addEventListener('click', switchTheme);
      
      // Initialize theme button
      updateThemeButton();

      // Animation timing now handled by loading coordinator


      const mediaQuery = window.matchMedia('(min-width: 800px)');

      function closeNav() {
        const navbar = document.getElementById("navbar");
        navbar.classList.remove("menu-open");
        navbar.classList.add("menu-closing");
        // Wait for fade out transition before hiding (0.5s transition + small buffer)
        setTimeout(() => {
          navbar.style.display = "none";
          navbar.classList.remove("menu-closing");
          document.getElementById("slide").style.height = "0%";
        }, 550);
        document.getElementById("toggle-button").style.display = "block";
      }

      function openNav() {
        const navbar = document.getElementById("navbar");
        // Remove closing class if it exists
        navbar.classList.remove("menu-closing");
        navbar.style.display = "flex";
        // Force reflow to ensure transition works
        navbar.offsetHeight;
        // Add class to trigger fade-in
        navbar.classList.add("menu-open");
        document.getElementById("toggle-button").style.display = "none";
        document.getElementById("slide").style.height = "100dvh";
      }

      mediaQuery.addEventListener('change', function() {
        if (mediaQuery.matches) {
          document.getElementById("navbar").style.display = "block";
          document.getElementById("toggle-button").style.display = "none";
        } else {
          document.getElementById("navbar").style.display = "none";
          document.getElementById("toggle-button").style.display = "block";
          
        }
      });

      // rainbow text on click
      document.querySelector('h1').addEventListener('click', function() {
        this.classList.toggle('wordsClick');
      });

      var chatInput = document.querySelector('.chatbot .chat-input');
      var textArea = document.querySelector('.chat-input textarea');

      textArea.addEventListener('click', function() {
        chatInput.classList.add('clicked');
      });

      document.addEventListener('click', function(event) {
        var isClickInside = textArea.contains(event.target);
        if (!isClickInside) {
          //the click was outside the .chat-input, so remove the 'clicked' class
          chatInput.classList.remove('clicked');
        }
      });

      document.getElementById('navbar').addEventListener('click', function (e) {
          if (e.target.textContent === "CONTACT") {
            if (mediaQuery.matches) {
              document.querySelector('form').style.display = 'block';
              document.querySelector('.chatbot').style.display = 'none';
              document.getElementById("slide").style.height = "0%";
              document.getElementById("navbar").style.display = "block";
              document.getElementById("toggle-button").style.display = "none";
            } else {
              document.querySelector('form').style.display = 'block';
              document.querySelector('.chatbot').style.display = 'none';
              closeNav();
            }
          }
        });

      document.getElementById('navbar').addEventListener('click', function (e) {
          if (e.target.textContent === "CHAT") {
            if (mediaQuery.matches) {
              document.querySelector('form').style.display = 'none';
              document.querySelector('.chatbot').style.display = 'block';
              document.getElementById("slide").style.height = "0%";
              document.getElementById("navbar").style.display = "block";
              document.getElementById("toggle-button").style.display = "none";
            } else {
              document.querySelector('form').style.display = 'none';
              document.querySelector('.chatbot').style.display = 'block';
              closeNav();
            }
          }
        });
    
    </script>

  </body>

</html>
